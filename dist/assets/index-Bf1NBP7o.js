const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jszip-BoYr3UI2.js","assets/vendor-wpXbf5jk.js"])))=>i.map(i=>d[i]);
import{r as p,a as A,R as B}from"./vendor-wpXbf5jk.js";import{J as I}from"./jszip-BoYr3UI2.js";import{M as T,S as M,L as Z,U as J,a as q,F as W,b as K,A as Q,D as Y}from"./icons-CixMXbmB.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function i(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(t){if(t.ep)return;t.ep=!0;const o=i(t);fetch(t.href,o)}})();var U={exports:{}},F={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H=p,V=Symbol.for("react.element"),G=Symbol.for("react.fragment"),X=Object.prototype.hasOwnProperty,ee=H.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,te={key:!0,ref:!0,__self:!0,__source:!0};function $(f,r,i){var a,t={},o=null,s=null;i!==void 0&&(o=""+i),r.key!==void 0&&(o=""+r.key),r.ref!==void 0&&(s=r.ref);for(a in r)X.call(r,a)&&!te.hasOwnProperty(a)&&(t[a]=r[a]);if(f&&f.defaultProps)for(a in r=f.defaultProps,r)t[a]===void 0&&(t[a]=r[a]);return{$$typeof:V,type:f,key:o,ref:s,props:t,_owner:ee.current}}F.Fragment=G;F.jsx=$;F.jsxs=$;U.exports=F;var e=U.exports,D,k=A;D=k.createRoot,k.hydrateRoot;const re="modulepreload",se=function(f){return"/"+f},R={},ne=function(r,i,a){let t=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),d=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));t=Promise.allSettled(i.map(u=>{if(u=se(u),u in R)return;R[u]=!0;const x=u.endsWith(".css"),N=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${N}`))return;const h=document.createElement("link");if(h.rel=x?"stylesheet":re,x||(h.as="script"),h.crossOrigin="",h.href=u,d&&h.setAttribute("nonce",d),document.head.appendChild(h),x)return new Promise((c,S)=>{h.addEventListener("load",c),h.addEventListener("error",()=>S(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(s){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=s,window.dispatchEvent(d),!d.defaultPrevented)throw s}return t.then(s=>{for(const d of s||[])d.status==="rejected"&&o(d.reason);return r().catch(o)})},_=new Uint8Array([214,2,8,0,244,254,255,63,1,0,0,0,208,202,1,0]);class ae{async xorData(r){const i=new Uint8Array(r),a=new Uint8Array(i.length);for(let t=0;t<i.length;t++)a[t]=i[t]^_[t%_.length];return a.buffer}async processFile(r,i,a){try{const t=await r.arrayBuffer();let o;if(i==="decrypt"){const s=t.slice(8),d=await this.xorData(s);o=await new Response(new Blob([d]).stream().pipeThrough(new DecompressionStream("deflate"))).arrayBuffer()}else{const s=await new Response(new Blob([t]).stream().pipeThrough(new CompressionStream("deflate"))).arrayBuffer(),d=await this.xorData(s),u=new Uint8Array(8).fill(0),x=new Uint8Array(8+d.byteLength);x.set(u),x.set(new Uint8Array(d),8),o=x.buffer}return new File([o],r.name,{type:r.type})}catch(t){throw console.error(`Error processing file ${r.name}:`,t),t}}async processFiles(r,i,a){const t=[],o=r.length;for(let s=0;s<r.length;s++){const d=r[s];try{const u=await this.processFile(d,i);t.push({originalFile:d,processedFile:u,status:"success"}),a&&a((s+1)/o*100)}catch(u){t.push({originalFile:d,error:u instanceof Error?u.message:"Unknown error",status:"error"}),a&&a((s+1)/o*100)}}return t}async createZipFromFiles(r){const i=new I;for(const a of r){const t=await a.arrayBuffer();i.file(a.name,t)}return await i.generateAsync({type:"blob"})}}const j=B.memo(({icon:f,...r})=>e.jsx(f,{...r}));function oe(){const[f,r]=p.useState([]),[i,a]=p.useState(!1),[t,o]=p.useState(0),[s,d]=p.useState([]),[u,x]=p.useState("encrypt"),[N,h]=p.useState(!1),[c,S]=p.useState(!1);p.useEffect(()=>{const n=()=>{const l=new Date().getHours();S(l>=20||l<8)};n();const m=setInterval(n,6e4);return()=>clearInterval(m)},[]),p.useEffect(()=>{document.documentElement.classList.toggle("dark",c)},[c]);const E=p.useCallback(n=>{const m=n.target.files;if(!m)return;const l=100*1024*1024,y=Array.from(m).filter(b=>b.size>l?(alert(`文件 ${b.name} 超过100MB限制`),!1):!0);r(y),h(!!n.target.getAttribute("webkitdirectory"))},[]),L=p.useCallback(n=>{var m,l;if(n.preventDefault(),n.dataTransfer.files){const y=Array.from(n.dataTransfer.files),b=100*1024*1024,v=y.filter(w=>w.size>b?(alert(`文件 ${w.name} 超过100MB限制`),!1):!0);r(v);const g=new Set(y.map(w=>w.webkitRelativePath.split("/")[0]));h(g.size>1||(((l=(m=y[0])==null?void 0:m.webkitRelativePath)==null?void 0:l.includes("/"))??!1))}},[]),C=p.useCallback(n=>{n.preventDefault()},[]),O=async()=>{if(f.length===0)return;const n=f.reduce((l,y)=>l+y.size,0),m=500*1024*1024;if(n>m){alert("总文件大小超过500MB限制");return}a(!0),o(0);try{const y=await new ae().processFiles(f,u,b=>{o(b)});d(y)}catch(l){console.error("Processing error:",l)}finally{a(!1)}},P=p.useCallback(async n=>{const m=URL.createObjectURL(n),l=document.createElement("a");l.href=m,l.download=n.name,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(m)},[]),z=p.useCallback(async()=>{try{const{default:n}=await ne(async()=>{const{default:g}=await import("./jszip-BoYr3UI2.js").then(w=>w.j);return{default:g}},__vite__mapDeps([0,1])),m=new n,l=s.filter(g=>g.status==="success"&&!!g.processedFile).map(g=>g.processedFile);if(l.length===0)return;for(const g of l){const w=await g.arrayBuffer();m.file(g.name,w)}const y=await m.generateAsync({type:"blob"}),b=URL.createObjectURL(y),v=document.createElement("a");v.href=b,v.download=`processed_files_${Date.now()}.zip`,document.body.appendChild(v),v.click(),document.body.removeChild(v),URL.revokeObjectURL(b)}catch(n){console.error("Error creating zip:",n),alert("创建ZIP文件时出错")}},[s]);return e.jsx("div",{className:`min-h-screen py-8 px-4 transition-colors duration-300 ${c?"bg-gray-900 text-white":"bg-gray-50 text-gray-900"}`,children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(j,{icon:c?T:M,className:c?"w-6 h-6 text-yellow-400":"w-6 h-6 text-yellow-500"})}),e.jsx("h1",{className:`text-3xl font-bold mb-2 ${c?"text-white":"text-gray-900"}`,children:"迷你世界文件加解密工具"}),e.jsx("p",{className:c?"text-gray-300":"text-gray-600",children:"支持所有文件格式"})]}),e.jsxs("div",{className:`rounded-lg shadow-md p-6 ${c?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-center gap-4 mb-6",children:[e.jsxs("button",{onClick:()=>x("encrypt"),className:`flex items-center gap-2 px-4 py-2 rounded-md transition-colors ${u==="encrypt"?"bg-blue-600 text-white":c?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"}`,children:[e.jsx(j,{icon:Z,size:20}),"加密"]}),e.jsxs("button",{onClick:()=>x("decrypt"),className:`flex items-center gap-2 px-4 py-2 rounded-md transition-colors ${u==="decrypt"?"bg-blue-600 text-white":c?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-700"}`,children:[e.jsx(j,{icon:J,size:20}),"解密"]})]}),e.jsx("div",{className:`border-2 border-dashed rounded-lg p-8 text-center ${c?"border-gray-600":"border-gray-300"}`,onDrop:L,onDragOver:C,children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(j,{icon:q,className:"text-gray-400"}),e.jsx("p",{className:c?"text-gray-300":"text-gray-600",children:"拖拽文件到这里，或者点击下方按钮选择文件"}),e.jsxs("div",{className:"flex flex-wrap gap-4 justify-center",children:[e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md cursor-pointer hover:bg-blue-700",children:[e.jsx(j,{icon:W,size:20}),"选择文件",e.jsx("input",{type:"file",multiple:!0,onChange:E,className:"hidden"})]}),e.jsxs("label",{className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md cursor-pointer hover:bg-blue-700",children:[e.jsx(j,{icon:K,size:20}),"选择文件夹",e.jsx("input",{type:"file",multiple:!0,onChange:E,className:"hidden",webkitdirectory:"true"})]})]})]})}),f.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h3",{className:`font-semibold mb-2 ${c?"text-white":"text-gray-900"}`,children:"已选择的文件："}),e.jsx("ul",{className:`text-sm max-h-40 overflow-y-auto ${c?"text-gray-300":"text-gray-600"}`,children:f.map((n,m)=>e.jsxs("li",{className:"mb-1",children:[n.name," (",(n.size/1024).toFixed(2)," KB)"]},m))}),e.jsx("button",{onClick:O,disabled:i,className:"mt-4 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-gray-400 disabled:cursor-not-allowed",children:i?"处理中...":"开始处理"})]}),i&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700",children:e.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${t}%`}})}),e.jsxs("p",{className:`text-center text-sm mt-2 ${c?"text-gray-300":"text-gray-600"}`,children:["处理进度: ",t.toFixed(1),"%"]})]})]}),s.length>0&&e.jsxs("div",{className:`rounded-lg shadow-md p-6 mt-6 ${c?"bg-gray-800":"bg-white"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:`font-semibold ${c?"text-white":"text-gray-900"}`,children:"处理结果："}),N&&e.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:[e.jsx(j,{icon:Q,size:20}),"下载所有文件 (ZIP)"]})]}),e.jsx("ul",{className:"space-y-2",children:s.map((n,m)=>e.jsx("li",{className:`p-3 rounded-md ${n.status==="success"?c?"bg-green-900/20":"bg-green-50":c?"bg-red-900/20":"bg-red-50"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`text-sm ${c?"text-gray-300":"text-gray-900"}`,children:[n.originalFile.name,n.status==="error"&&e.jsxs("span",{className:"text-red-600 ml-2",children:["- 错误: ",n.error]})]}),n.status==="success"&&n.processedFile&&!N&&e.jsxs("button",{onClick:()=>P(n.processedFile),className:"flex items-center gap-1 text-sm text-blue-600 hover:text-blue-800",children:[e.jsx(j,{icon:Y,size:16}),"下载"]})]})},m))})]}),e.jsxs("div",{className:`text-center mt-8 text-sm ${c?"text-gray-400":"text-gray-500"}`,children:[e.jsx("p",{children:"作者：是史三问呀"}),e.jsx("p",{children:"QQ：2196634956"})]})]})})}D(document.getElementById("root")).render(e.jsx(p.StrictMode,{children:e.jsx(oe,{})}));
